<% include partials/header %>

<h1>Survey</h1>

<% include partials/question %>
<% include partials/modal %>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    //hide modal


    $("#submit").on('click', function(event){
      event.preventDefault();
      //check for name and image
      if($("#userName").val() === '' || $("#userImage").val() === ''){
        event.preventDefault();
        alert("Some required fields are empty!");
      }
      //grab user input
      let newUser = {
        name: $("#userName").val().trim(),
        image: $("#userImage").val().trim(),
        scores: [
          $("#question1").val().trim(),
          $("#question2").val().trim(),
          $("#question3").val().trim(),
          $("#question4").val().trim(),
          $("#question5").val().trim(),
          $("#question6").val().trim(),
          $("#question7").val().trim(),
          $("#question8").val().trim(),
          $("#question9").val().trim(),
          $("#question10").val().trim()
        ]
      };
      //post user to user data
      $.post('api/users', newUser).then(function(data){
          //show modal and display matched character
          $("#charMatch").html(data.matchName);
          $("#charMatchImage").html('src', data.matchImage);
      })
    })
  });
</script>
<% include partials/footer %>
